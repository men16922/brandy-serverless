소개

이 시스템은 **5단계 워크플로(분석 → 상호명 → 간판 → 인테리어 → 보고서)**를 통해 브랜딩을 생성하는 AI 챗봇입니다.

UI: Streamlit (AWS App Runner, Pause/Resume 활용)

API: API Gateway(HTTP API) + Lambda

오케스트레이션: Step Functions (Express 기본, Standard 선택 대기 단계만)

데이터: DynamoDB(세션) + S3(이미지/보고서)

AI: Bedrock 모델(Dev) / Chroma(Local)

확장 옵션: Strands Agents · Slack 인터페이스

요구사항
1. 세션 관리

POST /sessions → 새 세션 ID 발급, DynamoDB 초기화

GET /sessions/{id} → 현재 단계/결과 반환

단계 완료 시 세션 상태 업데이트

세션은 24시간 후 TTL 만료

2. 비즈니스 분석

POST /analysis → 업종/지역/규모 검증

5초 내 요약/점수 생성

업로드 이미지 → S3 저장

실패 시 폴백 결과 제공

3. 상호명 제안

POST /names/suggest → 5초 내 3개 후보 생성(설명/점수 포함)

재생성 시 중복 없는 새 후보 제공

재생성 횟수 3회 제한

최종 선택은 세션에 저장

4. 간판 이미지 생성

POST /signboards/generate → Step Functions 병렬 분기(DALL-E/SDXL/Gemini)

각 모델 30초 제한, 실패 시 폴백 이미지

결과는 S3 저장 + URL 반환

5. 인테리어 추천

POST /interiors/generate → 간판 기반 인테리어 3안 생성

병렬 처리, 30초 내 완료

색상/예산 메타데이터 포함

실패 시 폴백 이미지

6. PDF 보고서

POST /report/generate → Lambda 컨테이너로 PDF 생성

내용: 상호명, 간판 3안, 인테리어 3안, 색상/예산, 분석 요약

결과는 S3 저장, GET /report/url → presigned URL(10분) 제공

공통 요구사항
환경별 실행

Local: DynamoDB Local, MinIO, Chroma

Dev: DynamoDB, S3, Bedrock KB

VectorStore 추상화로 Chroma ↔ Bedrock KB ↔ S3 Vector 교체 가능

성능

텍스트 응답 ≤ 5초

이미지 생성 ≤ 30초

전체 워크플로 ≤ 5분

안정성

Lambda/Step Functions 자동 재시도

DLQ 활용

폴백 결과 제공

보안

최소권한 IAM

데이터 암호화

Secrets Manager

presigned URL 제한시간 적용

관찰성

CloudWatch Logs + X-Ray 추적

SNS 알림

구조화 로그(trace_id, session_id, stage, latency_ms)

비용 최적화 포인트

App Runner: 발표 전 Resume, 이후 Pause (컴퓨트 0원)

API Gateway: HTTP API (REST 대비 저비용)

Step Functions: Express 기본, Standard 최소화

S3: 이미지 1024px, n=3 / Lifecycle로 IA·Glacier 이동

DynamoDB: On-Demand + TTL 24h

Bedrock 호출: 경량 모델 우선, 프롬프트 캐싱

선택 확장
Strands Agents

분석/네이밍 구간을 **Strands Agents(리액트 패턴)**로 프로토타이핑 가능

툴 예시: kb.search, name.score, image.generate

에이전트 단계별 로그(agent, tool, latency_ms)를 구조화 로그에 포함

Interpreter는 샌드박스 모드만 허용

Slack 인터페이스

Slack Events API → API Gateway → Lambda 연동

명령 세트 예: /brand analyze, /brand name, /brand signboard, /brand interior, /brand report

긴 작업은 결과 URL을 비동기 DM으로 회신

입력 검증(정규식)으로 안전성 확보